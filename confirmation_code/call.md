### 数据预处理
导入“附件1语音业务用户满意度数据”，数据共有5433个观测，55个变量。

#### 缺失值处理
按照附件五的说明，我们对缺失值做以下处理：
1. 填补‘是否关怀用户’，‘是否去过营业厅’字段中的缺失值为“否”。
2. 删除缺失值大于等于5个的观测。
3. 填补‘外省流量占比’字段的缺失值为该字段中位数。
4. 为了简化数据分析，我们对'其他，请注明','用户描述','其他，请注明.1','用户描述.1','终端品牌类型','用户id'，'重定向次数','重定向驻留时长'等缺失率达90%以上的变量采取删除策略。

#### 重编码
1. ‘是否遇到过网络问题’字段中的2，重编码为0，表示没有遇到网络问题。
2. '居民小区', '办公室', '高校', '商业街', '地铁', '农村', '高铁', '手机没有信号', '有信号无法拨通','通话过程中突然中断', '通话中有杂音、听不清、断断续续', '串线', '通话过程中一方听不见' 字段中的-1，重编码为0，其他数值，重编码为1,表示该场景或该问题曾经发生过。
3. '4\\5G用户'字段中，将“2G”重编码为0；“4G”重编码为1；“5G”重编码为2。表示网络制式逐级递增。
4. '语音方式'字段中的'VoLTE'，重新改写为'VOLTE'，此处应该是录入失误，二者并无差别。
5. '是否关怀用户','是否去过营业厅','是否4G网络客户（本地剔除物联网）', '是否5G网络客户', '是否实名登记用户'字段中的“是”，重编码为1；“否”重编码为0。
6. 考虑终端品牌市场占有率，‘终端品牌’字段重编码为“苹果”、“华为”、“小米”和“其他”四类。
7. 查阅北京移动客户分级相关资料，‘客户星级标识’字段重分类为（未评级准星一星二星）/（三星）/（银卡）/(金卡，白金卡，钻石卡)，并且分别赋值1，2，3，4，表示等级由低到高。
8. 最后使用独热编码处理'语音方式','终端品牌'字段。

#### 异常值
定量变量字段有：'套外流量（MB）','套外流量费（元）', '外省语音占比', '外省流量占比','语音通话-时长（分钟）', '省际漫游-时长（分钟）',
'ARPU（家庭宽带）','当月ARPU', '当月MOU', '前3月ARPU', '前3月MOU',
'GPRS总流量（KB）', 'GPRS-国内漫游-流量（KB）','当月欠费金额', '前第3个月欠费金额'，考虑处理如下：
1. 画出定量变量箱线图，直方图，发现16个数值变量中大多数为0，呈现右偏分布，存在异常值，但是考虑实际业务场景中通话时长较长或者上网较多的用户相比于一般用户更能够从中通话中发现问题，因此综合考虑，采用截尾方法处理，将大于$\mu+3\sigma$的数据标记为截尾,替换对应数值为列均值加三倍标准差。

次数变量字段有：'脱网次数','mos质差次数', '未接通掉话次数'，考虑处理如下：
1. 对每一个变量使用K均值聚类，目标类数目设定为5，将次数变量离散化处理，保证了极端值包含的信息不缺失。

### 创建BaseLine
将上述处理好的数据分别带入RF，LGB,XGB分类器中，得到同一验证集上分类准确率分别为：56.8%、56.0%和51.2%，采用随机森林分类器作为Base进行对比。

### 特征选择
#### 训练集与测试集对齐
1. 由于训练集和测试集存在变量字段不一致的情况，首先对训练集和测试集的初始特征进行对齐，
2. 将家宽投诉和资费投诉合并为新的变量“是否投诉”，若家宽投诉和资费投诉均为0，则是否投诉等于0，否则等于1.

#### 剔除强相关性，强一致性和重要程度低的变量
1. 对于定量变量，使用person和spearman相关系数同时验证，剔除相关系数大于0.7并且显著性水平小于0.05的变量有：'前3月MOU','语音通话-时长（分钟）',
'外省流量占比','外省语音占比','省际漫游-时长（分钟）','前第3个月欠费金额','套外流量费（元）','前3月ARPU'。
2. 对于分类变量，采用基于树模型变量选择，剔除重要程度小于0.3%的变量：'家宽投诉','资费投诉','语音方式_GSM','语音方式_VONR','是否4G网络客户（本地剔除物联网）。

#### 特征衍生
1. 构建三大分项满意度特征
2. 使用最小值、均值、最大值、标准差统计量构建客户特征。
3. 将新构建的特征并入原始特征建模，并依据特征重要性筛选特征。

### 参数优化
使用网格搜索交叉验证方法寻找最优参数，待优化参数有：max_depth,max_samples,min_samples_leaf,min_samples_split,n_estimators,max_features。

### 预测结果
